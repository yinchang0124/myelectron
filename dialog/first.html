<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>my first app</title>
</head>
<body>
<h1>my first app</h1>

<div class="demo-controls">
    <button class="demo-button1" id="select-dir"> 打开文件夹</button>
    <button class="demo-button1" id="open"> 打开微信</button>
    <!--<button class="demo-button2" id="open-ex-links"> 打开链接</button>-->
    <textarea id ="selected-file"></textarea>
    <input type="button" onclick="javascript:LaunchApp()" value="执行EXE"/>
</div>

<script>
    require('./dialog.js');
</script>
<script>
    function LaunchApp() {
        var exepath="/home/yc/run.sh";
        if (!document.all) {
            netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
            var file = window.Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);
            file.initWithPath(exepath);
            var run = window.Components.classes['@mozilla.org/process/util;1'].createInstance(Components.interfaces.nsIProcess);
            run.init(file);
            var parameters = [""];
            run.run(false, parameters, parameters.length);
        }
        else {
            var ws = new ActiveXObject("WScript.Shell");
            ws.Exec(path1);
        }
    }
</script>
</body>
</html>